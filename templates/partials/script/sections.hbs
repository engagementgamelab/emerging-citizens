{{!< default}}
{{!-- 
/**
 * Emerging Citizens
 * Developed by Engagement Lab, 2016
 * ==============
 * 
 * Script includes partial for individual sections
 * ==========
 */
--}}

<script type="text/javascript">
	localStorage.debug = '*';
	
	$(document).ready(function() {
			
    socket = io('/hashtag-youre-it');
		
		{{!-- INDEX Template Script --}}
		{{#ifeq section 'home'}}

   	socket.on('connect', function() {
		   // Connected, let's sign-up for to receive messages for this room
		   socket.emit('room', 'lobby');
		});

    socket.on('user:update', function(msg) {
    	$('.login-box').hide();
	    $('#team').html(_.pluck(msg, 'username').join('<br />'));
 	  });

    socket.on('game:start', function(html) {
	    $('#gameContent').html(html);
 	  });

		$('#btn_submit').click(function(e) {
		  socket.emit('hashtagSubmitted', $('#tweet_input').val());
		});

		$('#btn_submit').click(function(e) {
		  socket.emit('loginSubmit', {room: 'lobby', username: $('#player_name').val()});
		});
		{{/ifeq}}

		{{#ifeq section 'moderator'}}

		$('#btn_submit').click(function(e) {
			var data = $(":input").serializeArray();
		  $.post( 
		  	"/api/create/",
				data,
				function( data ) {
				  window.location = data;
				}
			);
		});

		{{/ifeq}}

		{{#ifeq section 'moderator/monitor'}}

   	socket.on('connect', function() {
		   socket.emit('getUsers');
		});

    socket.on('user:update', function(msg) {
	  	console.log(_.pluck(msg, 'username'))
	    $('#team').html(_.pluck(msg, 'username').join('<br />'));
 	  });

    socket.on('player:login', function(msg) {
	  	console.log(msg)
	    // $('#team').html(msg.join('<br />'));
 	  });

    socket.on('hashtagReceived', function(msg) {
	  	console.log(msg);
	  	$('#team').append('<br />User ' + msg.user + ' sent in hashtag #' + msg.hashtag);
 	  });
	
		{{/ifeq}}
});

</script>