var clockInterval,wikiAnimSlider,gameEvents=function(a,b){function c(){var a=$("#countdown #text"),b=10,c=setInterval(function(){b--,$(a).text(b),0==b&&(clearInterval(c),$("#winners-circle")[0]?location.href="\\":socket.emit("game:next_round",emitData(null)))},1e3)}function d(){$("#results, #results-header").show(),m.fromTo($("#results-header"),1,{autoAlpha:0,delay:0},{autoAlpha:1}).add("resultsShow").from($("#results"),1,{autoAlpha:0,scale:0,ease:Bounce.easeOut,delay:0},"resultsShow+=1").staggerFromTo($("#results .user"),1,{autoAlpha:0,scale:1,y:250},{autoAlpha:1,scale:1,y:0,ease:Bounce.easeOut},.5,"resultsShow+=3").to($("#results"),1,{autoAlpha:0,scale:0,display:"none",ease:Bounce.easeOut},"resultsShow+=9").add("scoringShow").add(function(){$("#scoring").show()}).from($("#scoring"),1,{autoAlpha:0,scale:0,ease:Bounce.easeOut},"scoringShow+=1").staggerFromTo($("#scoring .user"),1,{autoAlpha:0,scale:1,y:250},{autoAlpha:1,scale:1,y:0,ease:Bounce.easeOut},.5,"scoringShow+=3").to($("#scoring"),1,{autoAlpha:0,scale:0,display:"none",ease:Bounce.easeOut},"scoringShow+=7").add("leadersShow").add(function(){$("#leaderboard, #count").show()}).from($("#leaderboard"),1,{autoAlpha:0,scale:0,ease:Bounce.easeOut},"leadersShow+=1").staggerFromTo($("#leaderboard .user"),1,{autoAlpha:0,scale:1,y:250},{autoAlpha:1,scale:1,y:0,ease:Bounce.easeOut},.5,"leadersShow+=3").from($("#countdown"),1,{autoAlpha:0,ease:Bounce.easeOut},"leadersShow+=7"),$("#slider-gsap").length&&(wikiAnimSlider=new GSAPTLSlider(m,"slider-gsap",{width:600})),m.play()}switch(a){case"game:countdown":var e=$(".countdown"),f=$("#countdown #text"),g=$("#article-reveal #countdown #text"),h=b.duration,i=b.name;clockInterval&&clearInterval(clockInterval),clockInterval=setInterval(function(){h--;var a=secondsToHms(h);if($(f).html(a),$(g).html(a),"hidden"===e.css("visibility")&&TweenLite.from(e,.5,{autoAlpha:0,scale:.5,ease:Elastic.easeOut}),0==h&&"topicCountdown"===i&&clearInterval(clockInterval),0==h&&"articleReveal"===i)clearInterval(clockInterval);else if(5==h&&"topicCountdown"===i){var b=$("#article-reveal");e.fadeOut(300),b.fadeIn(500,function(){TweenLite.from($(b).find("#content"),.5,{autoAlpha:0,scale:.5,ease:Elastic.easeOut})});var c=new ProgressBar.Circle("#article-reveal #countdown",{color:"#fff",duration:1e3*h,easing:"easeInOut",strokeWidth:6,trailColor:"#f4f4f4",trailWidth:.8,fill:"#00c5c2",from:{color:"#00c5c2",width:1},to:{color:"#fff",width:4},step:function(a,b){b.path.setAttribute("stroke",a.color),b.path.setAttribute("stroke-width",a.width),b.setText(h)}});c.animate(1)}},1e3);break;case"topic:info":$("#gameContent").html(b.html),$("#reveal").html(b.reveal),$("#overlay").fadeOut().empty(),$("#goto_results").hide();var j=$(".player-static"),k=_.pluck(_.where(b.players,{finished:!0}),"username");_.each(k,function(a,b){var c=a.length<=15?a:a.substring(0,15)+"...";$(j[b]).children(".icon").addClass("active"),$(j[b]).children(".nameplate").addClass("active").text(c)});break;case"player:finished":var j=$(".player-static"),k=_.pluck(_.where(b,{finished:!0}),"username");_.each(k,function(a,b){var c=a.length<=15?a:a.substring(0,15)+"...";$(j[b]).children(".icon").addClass("active"),$(j[b]).children(".nameplate").addClass("active").text(c)});break;case"wiki:waiting":$(".countdown #countdown").fadeOut(500,function(){$(".countdown #out-of-time").fadeIn(500)}),$("#goto_results").show();break;case"wiki:click":new TimelineLite({paused:!0});break;case"wiki:results":updateGameContent(b),clearInterval(clockInterval);var l=new TimelineLite({paused:!0,onComplete:function(){d()}}),m=new TimelineLite({paused:!0,onComplete:function(){c()}}),n=$("#top-players .player-path");_.each(n,function(a,b){var c=$(a).find(".title"),d=$(a).find(".articleDot"),e=$(a).find(".articleLine"),f=c.size();$(f).find(".destination");l.from($(a),2,{autoAlpha:0,scale:0,ease:Bounce.easeOut,delay:1}),_.each(c,function(a,b){l.from($(a),.5,{autoAlpha:0,scale:0,ease:Bounce.easeOut,delay:1,onStart:function(){var a=$(e[b]);$(d[b]).velocity({r:8},500,[50,10]),a.velocity({x2:a.data().x2,y2:a.data().y2},1e3,[50,10])}})}),l.to($(a),1,{autoAlpha:0,scale:0,display:"none",ease:Bounce.easeOut,delay:5})}),l.play();break;case"game:countdown_end":}};